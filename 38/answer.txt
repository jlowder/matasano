-------> S               x = SHA256(salt|password)
salt=0x03 P=0x76616E696C6C61 Sx=0x47E38B04783F5A6921111D552A37E96B50DB069FC57D2A3E0489444CAF245D34 
------->                 v = g**x % n
g=2 v=1537791003661407692485395820559912877923663543616790829145973239464625888658471114869803146858803139903496349523943498681359114765576371140585161546007596278256643611415945253654813616996085134756890228695713593928451673297539964252077501332160823222532750399713524351780026729552699619697413386914900804997880759254036674542107109145241094645419036051253796392230402175061450637845651779309430562874215436783812997860139534038566403275763991133129781649627047812 
-------> C->S            I, A = g**a % n
I=ice@itsnotreal.com A=238794577014625705766148168477589567724825036150507568419739862145133395149590271934775181282349800806656774069590931764109969846611145932940318796633861710813900040296591043414373477341387858422695860896550178295878638693363588200145838943863537599977616990013541075157772718678550367767201506034867720370401299160558394469366093684026366051908852191133970099659084695885187411238427897818368574329741296913466055616276197885886337813191208203965314765540181028 
-------> S->C            salt, B = g**b % n, u = 128 bit random number
salt=0x03 B=802205856450527642835278577527949518287205562171718992546342743934819712157690878895233678778742300319521710237130597802519179712857988018172648944731694295284453750419864672115470901045532968039167175552925089593676634792648972229213296136005849933892447600395930007348073706232910035169048284553060359175669728977177299070433599785255252463696584231362842656594617815697838114430815919311243850580656766579918825230926574596030734384509673775024285340832148146 u=60240995238997829632140578779206863965 
-------> C               x = SHA256(salt|password)
Cx=0x47E38B04783F5A6921111D552A37E96B50DB069FC57D2A3E0489444CAF245D34 
------->                 S = B**(a + ux) % n
Cs=19214444952604710073049100954678925627061964047596904191657326743227592708325735962796294944992981413428247371318701948434167443920789920455354714772344054434683919878440358058678032750211108209569765078149096209076030800731353369344360130764245978429069251099069433989531956751319398197041284372464413946654507800308919166841002358525062991574721756728177443866151613650918169693959964252183204410966822832712560511355774572924568179408835503856310883010147670 
------->                 K = SHA256(S)
Ck=0xA1E74D9AD8F109E39F67BB2C8ED2623B8B33888C3C6E0761E547A01C6FAFC8DD 
-------> S               S = (A * v ** u)**b % n
Ss=19214444952604710073049100954678925627061964047596904191657326743227592708325735962796294944992981413428247371318701948434167443920789920455354714772344054434683919878440358058678032750211108209569765078149096209076030800731353369344360130764245978429069251099069433989531956751319398197041284372464413946654507800308919166841002358525062991574721756728177443866151613650918169693959964252183204410966822832712560511355774572924568179408835503856310883010147670 
------->                 K = SHA256(S)
Sk=0xA1E74D9AD8F109E39F67BB2C8ED2623B8B33888C3C6E0761E547A01C6FAFC8DD 
-------> C->S            Send HMAC-SHA256(K, salt)
Client-HMAC-SHA256=0x8FB0C8525BE55F8F1D6DDDDD94167AD9D91A6DD48F8977CDDFA651D9D70CCD89 
-------> S->C            Send "OK" if HMAC-SHA256(K, salt) validates
"OK"
[Redoing with MITM attacker posing as server]
-------> Seting salt to arbitrary value
salt=0x00 
-------> C->S            I, A = g**a % n
I=ice@itsnotreal.com a=2014702408805641686010754137411380955121722801187376906434796426736586379178474027046317417379773033543965306730977155931220919242321750398513727294301988793458865280902255512446702748765910508328787364608286009421145797561609555550155848481139625856775534686929987163076050354533263632192780439144308034080238951646513098797218272430544304939302765413530696069308614570559659931493602888234532828939625619457939097940355781651631711912756417253503151324777930296 A=2069113084839916069637345881261806497782937882327444189851911058832079266527707280504112719439396271133173570036335206659544190741989755045943450251176191604512996438618502340615321931829918240292411594166671687260709028063574026785106962350845055550562928550252078481095409570235628619594661436301153742969802028268401297723776692330694453639850397413586213981562333928377501972111099537599452817569276382844911498861595903124378426088609106081424362346803250821 
-------> S->C            salt, B = g**b % n, u = 128 bit random number
salt=0x00 B=1031837709549541774520827864477264087912595936629668231745997347047721372538823596105084971125442407309475958458827487970441212835829069357504151712259688086459754268023383924017917705383751025323870039768713732614098652508462707819527835686504939312240123870887075850383361693515342223215058092671483588906885613536996493238713573435819173504708379609899659412616683344185894550867730133719679351466965956314152391475141813382356891191154279083033941674352037552 u=1 
-------> C               x = SHA256(salt|password)
Cx=0xAC230ABBFC28CDE26032C7A2A83EDB7BDA127BA2BB5984345EA6DE41BE25228B 
------->                 S = B**(a + ux) % n
Cs=1390597309329193021955336100966130564628035054484590835911774696534723959453841508283818528809066524915548074264528653843592877842168650007594565378887807603349989364195574441403323884373179889559345566575870993074068423904871388050165933886204295253684243650469861553599792665151306845999083284452131747031238600809569564251626619354390055844857975499324421569102443586631287445385905013644966522734504274184142588015770914238859200523494532477191656570554297014 
------->                 K = SHA256(S)
Ck=0xF0DBFCEF19D4FE156680A1D53324111ABB27926588648AF6340CB07A803D21AE 
-------> C->S            Send HMAC-SHA256(K, salt)
Client-HMAC-SHA256=0x9084946384DF7C35DC92BB40E175159A3AB7C3193EA627203586AE879E2F50E1 
[performing dictionary search]
found the password!
-------> vanilla
