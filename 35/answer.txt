First: test without a MITM
p: 2410312426921032588552076022197566074856950548502459942654116941958108831682612228890093858261341614673227141477904012196503648957050582631942730706805009223062734745341073406696246014589361659774041027169249453200378729434170325843778659198143763193776859869524088940195577346119843545301547043747207749969763750084308926339295559968882457872412993810129130294592999947926365264059284647209730384947211681434464714438488520940127459844288859336526896320919633919 g: 2
64
B received: cde5a8f6a7c0c1d252dd321e08b7c894cc4b91bf3fb0a279796b19fcac60ea4819b3e06218fbfdb9e668bed14b9a1228a854f8d5dee2474821e6b0eafb825b05
B decrypted: #"This is a test with no man in the middle."
64
A received: 83a43f77df8f5430e28aa79912ef5c51135bfd1020690cef351bd52ab81e1efd458d482ceefdd44c8074da50a5f76fb57f4087db144b1cc64d4608c87c9882c5
A decrypted: #"This is a test with no man in the middle."
64


test with a MITM, g=1
"resetting participant"
"resetting participant"
p: 2410312426921032588552076022197566074856950548502459942654116941958108831682612228890093858261341614673227141477904012196503648957050582631942730706805009223062734745341073406696246014589361659774041027169249453200378729434170325843778659198143763193776859869524088940195577346119843545301547043747207749969763750084308926339295559968882457872412993810129130294592999947926365264059284647209730384947211681434464714438488520940127459844288859336526896320919633919 g: 1
p: 2410312426921032588552076022197566074856950548502459942654116941958108831682612228890093858261341614673227141477904012196503648957050582631942730706805009223062734745341073406696246014589361659774041027169249453200378729434170325843778659198143763193776859869524088940195577346119843545301547043747207749969763750084308926339295559968882457872412993810129130294592999947926365264059284647209730384947211681434464714438488520940127459844288859336526896320919633919 g: 1
64
M: read from A: cde5a8f6a7c0c1d252dd321e08b7c894afc387207de66cf39139ce9af7b7398d411f110be295f447c14c6dd2890c97b1e3979fe9693241267206208c9c7a79a5
M: decrypting A's message to #"This is with a man in the middle using g=1"
B received: cde5a8f6a7c0c1d252dd321e08b7c894afc387207de66cf39139ce9af7b7398d411f110be295f447c14c6dd2890c97b1e3979fe9693241267206208c9c7a79a5
B decrypted: #"This is with a man in the middle using g=1"
M: read from B: 83a43f77df8f5430e28aa79912ef5c51e62c902b9a2da68187e81456d74611731b5713358709305901a8125701939b4a450dd223f80bcb5d6dd5743e3188cbeb
M: decrypting B's return message to #"This is with a man in the middle using g=1"
A received: 83a43f77df8f5430e28aa79912ef5c51e62c902b9a2da68187e81456d74611731b5713358709305901a8125701939b4a450dd223f80bcb5d6dd5743e3188cbeb
A decrypted: #"This is with a man in the middle using g=1"
64


test with a MITM, g=p
"resetting participant"
"resetting participant"
p: 2410312426921032588552076022197566074856950548502459942654116941958108831682612228890093858261341614673227141477904012196503648957050582631942730706805009223062734745341073406696246014589361659774041027169249453200378729434170325843778659198143763193776859869524088940195577346119843545301547043747207749969763750084308926339295559968882457872412993810129130294592999947926365264059284647209730384947211681434464714438488520940127459844288859336526896320919633919 g: 2410312426921032588552076022197566074856950548502459942654116941958108831682612228890093858261341614673227141477904012196503648957050582631942730706805009223062734745341073406696246014589361659774041027169249453200378729434170325843778659198143763193776859869524088940195577346119843545301547043747207749969763750084308926339295559968882457872412993810129130294592999947926365264059284647209730384947211681434464714438488520940127459844288859336526896320919633919
p: 2410312426921032588552076022197566074856950548502459942654116941958108831682612228890093858261341614673227141477904012196503648957050582631942730706805009223062734745341073406696246014589361659774041027169249453200378729434170325843778659198143763193776859869524088940195577346119843545301547043747207749969763750084308926339295559968882457872412993810129130294592999947926365264059284647209730384947211681434464714438488520940127459844288859336526896320919633919 g: 2410312426921032588552076022197566074856950548502459942654116941958108831682612228890093858261341614673227141477904012196503648957050582631942730706805009223062734745341073406696246014589361659774041027169249453200378729434170325843778659198143763193776859869524088940195577346119843545301547043747207749969763750084308926339295559968882457872412993810129130294592999947926365264059284647209730384947211681434464714438488520940127459844288859336526896320919633919
64
M: read from A: cde5a8f6a7c0c1d252dd321e08b7c894a9c286690df1ff40bf0da3bb645659d59ed455aad5c6101f2722ddffc4674c216e4303cce6e26289066ea0bf636797f4
M: decrypting A's message to #"This is with a man in the middle using g=p"
B received: cde5a8f6a7c0c1d252dd321e08b7c894a9c286690df1ff40bf0da3bb645659d59ed455aad5c6101f2722ddffc4674c216e4303cce6e26289066ea0bf636797f4
B decrypted: #"This is with a man in the middle using g=p"
M: read from B: 83a43f77df8f5430e28aa79912ef5c515a61200ae92ac1fc0c933b9c52a41ba9497a6eee79a43a5a49212d21873968bd3e8f91e7010e0532d06ac17efc0eba6b
M: decrypting B's return message to #"This is with a man in the middle using g=p"
A received: 83a43f77df8f5430e28aa79912ef5c515a61200ae92ac1fc0c933b9c52a41ba9497a6eee79a43a5a49212d21873968bd3e8f91e7010e0532d06ac17efc0eba6b
A decrypted: #"This is with a man in the middle using g=p"
64


test with a MITM, g=(p-1)
"resetting participant"
"resetting participant"
p: 2410312426921032588552076022197566074856950548502459942654116941958108831682612228890093858261341614673227141477904012196503648957050582631942730706805009223062734745341073406696246014589361659774041027169249453200378729434170325843778659198143763193776859869524088940195577346119843545301547043747207749969763750084308926339295559968882457872412993810129130294592999947926365264059284647209730384947211681434464714438488520940127459844288859336526896320919633919 g: 2410312426921032588552076022197566074856950548502459942654116941958108831682612228890093858261341614673227141477904012196503648957050582631942730706805009223062734745341073406696246014589361659774041027169249453200378729434170325843778659198143763193776859869524088940195577346119843545301547043747207749969763750084308926339295559968882457872412993810129130294592999947926365264059284647209730384947211681434464714438488520940127459844288859336526896320919633918
p: 2410312426921032588552076022197566074856950548502459942654116941958108831682612228890093858261341614673227141477904012196503648957050582631942730706805009223062734745341073406696246014589361659774041027169249453200378729434170325843778659198143763193776859869524088940195577346119843545301547043747207749969763750084308926339295559968882457872412993810129130294592999947926365264059284647209730384947211681434464714438488520940127459844288859336526896320919633919 g: 2410312426921032588552076022197566074856950548502459942654116941958108831682612228890093858261341614673227141477904012196503648957050582631942730706805009223062734745341073406696246014589361659774041027169249453200378729434170325843778659198143763193776859869524088940195577346119843545301547043747207749969763750084308926339295559968882457872412993810129130294592999947926365264059284647209730384947211681434464714438488520940127459844288859336526896320919633918
64
M: read from A: cde5a8f6a7c0c1d252dd321e08b7c894afc387207de66cf39139ce9af7b7398d411f110be295f447c14c6dd2890c97b116cdbfaf78ce743b20d487607b2d9c1e
M: decrypting A's message to #"This is with a man in the middle using g=(p-1)"
B received: cde5a8f6a7c0c1d252dd321e08b7c894afc387207de66cf39139ce9af7b7398d411f110be295f447c14c6dd2890c97b116cdbfaf78ce743b20d487607b2d9c1e
B decrypted: #"This is with a man in the middle using g=(p-1)"
M: read from B: 83a43f77df8f5430e28aa79912ef5c51e62c902b9a2da68187e81456d74611731b5713358709305901a8125701939b4ab7a30638c89a20b5a9aabb809948ca8c
M: decrypting B's return message to #"This is with a man in the middle using g=(p-1)"
A received: 83a43f77df8f5430e28aa79912ef5c51e62c902b9a2da68187e81456d74611731b5713358709305901a8125701939b4ab7a30638c89a20b5a9aabb809948ca8c
A decrypted: #"This is with a man in the middle using g=(p-1)"
64
